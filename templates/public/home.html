{% extends "layout/base.html" %}
{% block title %}{{ t('home') }} – Carlos Sibrian{% endblock %}

{# --- 1. NAVBAR HOME (Solo Idioma) --- #}
{% block navbar %}
<div class="position-fixed top-0 end-0 p-4" style="z-index: 2000;">
    <a class="btn btn-sm btn-outline-light rounded-pill px-3" 
       href="{{ url_for('switch_lang', code='en' if current_lang()=='es' else 'es') }}"
       style="backdrop-filter: blur(5px); background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.2);">
      {{ current_lang()|upper }}
    </a>
</div>
{% endblock %}

{% block content %}

{# --- 2. MENÚ 3D --- #}
<div id="menu-container">
    <a href="{{ url_for('about') }}" class="menu-item">{{ t('about') }}</a>
    <a href="{{ url_for('projects_list') }}" class="menu-item">{{ t('projects') }}</a>
    <a href="{{ url_for('contact') }}" class="menu-item">{{ t('contact') }}</a>
</div>

{# --- 3. ESPACIADOR --- #}
<div style="height: 100vh; width: 100%; pointer-events: none;"></div>

{# --- 4. SECCIÓN CARRUSEL (FULL WIDTH) --- #}
<div id="featured-section" class="container-fluid position-relative d-flex flex-column justify-content-center" 
     style="z-index: 10; min-height: 100vh; padding: 0 !important; overflow-x: hidden; width: 100%; pointer-events: auto !important;">
  
  <div class="text-center mb-5 hero-header">
    <h2 class="text-light fw-bold display-5 text-uppercase" style="font-family: 'Space Grotesk'; letter-spacing: 3px; text-shadow: 0 0 20px rgba(255, 102, 0, 0.5);">
      Featured Projects
    </h2>
    <div style="width: 50px; height: 3px; background: var(--accent); margin: 20px auto;"></div>
  </div>

  {% if featured %}
    {# Wrapper de vidrio #}
    <div class="cyber-carousel-wrapper w-100 position-relative" style="background: rgba(5, 10, 15, 0.4); backdrop-filter: blur(10px); border-top: 1px solid rgba(255,255,255,0.1); padding: 80px 0;">
      
      {# Contenedor Centrado #}
      <div id="projectsCarousel" class="carousel slide mx-auto" data-bs-ride="carousel" style="max-width: 1000px; width: 100%; position: relative; overflow: visible;"> 
        
        <div class="carousel-inner" style="overflow: visible;"> 
          {% for project in featured %}
            <div class="carousel-item {% if loop.first %}active{% endif %}">
              
              <div class="d-flex justify-content-center align-items-center card-wrapper-height">
                  
                  {# Tarjeta #}
                  <a href="{{ url_for('project_detail', slug=project.slug) }}" class="cyber-card featured-card">
                    
                    <div class="cyber-img-container">
                      {% if project.video_url %}
                         <video class="cyber-video" autoplay muted loop playsinline poster="{{ project.cover_image }}">
                            <source src="{{ project.video_url }}" type="video/mp4">
                            <img src="{{ project.cover_image }}" class="cyber-img">
                         </video>
                      {% else %}
                         <img src="{{ project.cover_image }}" class="cyber-img" alt="{{ project.title }}">
                      {% endif %}
                    </div>

                    <div class="cyber-body">
                       <h3 class="cyber-title project-title">{{ get_loc_attr(project, 'title') }}</h3>
                       
                       <div class="tech-cloud mb-3">
                         {% for tech in project.tech_stack.split(',')[:3] %}
                            <span class="tech-tag">{{ tech.strip() }}</span>
                         {% endfor %}
                       </div>

                       <p class="cyber-summary project-summary">
                         {{ get_loc_attr(project, 'summary') | truncate(100) }}
                       </p>

                       <div class="cyber-footer mt-auto">
                          <span class="btn-cyber-link">EXPLORE >></span>
                       </div>
                    </div>

                  </a>
              </div>

            </div>
          {% endfor %}
        </div>
        
        <button class="carousel-control-prev arrow-outside" type="button" data-bs-target="#projectsCarousel" data-bs-slide="prev" style="left: -100px;">
          <svg class="neon-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
             <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        
        <button class="carousel-control-next arrow-outside" type="button" data-bs-target="#projectsCarousel" data-bs-slide="next" style="right: -100px;">
          <svg class="neon-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
             <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>

      </div>
    </div>
  {% endif %}
</div>

<style>
/* --- ESTILOS DE LA TARJETA RESPONSIVA --- */

/* Por defecto (Desktop) */
.featured-card {
    width: 100%;
    max-width: 450px;
    min-height: 520px;
    text-decoration: none;
    margin: 0 auto;
    transition: transform 0.3s ease;
}
.card-wrapper-height {
    min-height: 520px;
}
.project-title { font-size: 1.4rem; }
.project-summary { font-size: 0.95rem; }

/* Flechas Desktop */
.arrow-outside {
    width: 80px; height: 100%; opacity: 1 !important; position: absolute; top: 0; bottom: 0; display: flex; align-items: center; justify-content: center; background: transparent; border: none; z-index: 100;
}
.neon-arrow {
    width: 60px; height: 60px; color: rgba(255, 255, 255, 0.4); transition: all 0.3s; filter: drop-shadow(0 0 2px rgba(0,0,0,0.5));
}
.arrow-outside:hover .neon-arrow {
    color: var(--accent); transform: scale(1.3) translateX(5px); filter: drop-shadow(0 0 15px var(--accent)); stroke-width: 3;
}
.carousel-control-prev:hover .neon-arrow { transform: scale(1.3) translateX(-5px); }


/* --- MEDIA QUERIES (VERSIÓN MÓVIL) --- */
@media (max-width: 768px) {
    /* Reducir padding del wrapper */
    .cyber-carousel-wrapper {
        padding: 40px 0 !important;
    }
    
    /* Header más pequeño */
    .hero-header h2 {
        font-size: 2rem; /* Más pequeño que display-5 */
    }

    /* TARJETA MÁS PEQUEÑA */
    .featured-card {
        max-width: 300px; /* Mucho más angosta */
        min-height: 420px; /* Menos alta */
    }
    .card-wrapper-height {
        min-height: 440px;
    }
    
    /* Imagen más compacta */
    .featured-card .cyber-img-container {
        height: 180px; /* Reducimos altura de imagen */
    }

    /* Texto ajustado */
    .project-title { font-size: 1.2rem; }
    .project-summary { font-size: 0.85rem; }

    /* Flechas ajustadas para móvil */
    .arrow-outside { width: 40px; }
    
    /* Acercamos las flechas al borde de la pantalla */
    .carousel-control-prev[style] { left: -10px !important; }
    .carousel-control-next[style] { right: -10px !important; }
    
    .neon-arrow { width: 35px; height: 35px; color: rgba(255,255,255,0.8); } /* Más visibles por defecto en móvil */
}

/* Ajuste intermedio (Tablets) */
@media (max-width: 1200px) and (min-width: 769px) {
    .arrow-outside { width: 50px; }
    .carousel-control-prev[style] { left: -50px !important; }
    .carousel-control-next[style] { right: -50px !important; }
}
</style>
{% endblock %}